# 🤖 如何让 Claude Code Agent 自动处理整个小说

## 📋 简介

这个方案**不使用任何外部API**，而是让**我（Claude Code Agent）**来完成所有工作！

✅ 我会逐章阅读小说
✅ 我会分析每一章
✅ 我会提取角色、地点、物品、设定
✅ 我会每10章自动回顾
✅ 我会自动批准并继续
✅ 我会处理整个小说直到完成

---

## 🚀 启动步骤

### 方法一：一键启动（最简单）

在 Claude Code 中运行：

```bash
./START_AGENT_PROCESSOR.sh
```

**就这么简单！** 脚本会生成指令文件，然后我会自动读取并执行所有任务。

### 方法二：手动启动

如果您想更多控制：

#### 步骤1: 生成指令文件

```bash
python3 agent_novel_processor.py
```

这会生成：
- `agent_instructions/CURRENT_TASK.md` - 主指令文件
- `agent_instructions/task_chapter_XX.md` - 当前章节任务
- `data/` 目录结构 - 用于存储分析结果

#### 步骤2: 让我读取指令

**直接对我说**：

> 请读取 `agent_instructions/CURRENT_TASK.md` 并按照指令执行

或者直接说：

> 开始处理小说，从当前进度继续

---

## 📖 我会做什么

当您启动后，我会自动执行以下流程：

### 对于每一章：

```
1. 📖 读取小说文件的第N章（完整阅读，不跳过）
   ↓
2. 🔍 使用 01-小说分析器.md 分析章节
   - 提取核心事件
   - 识别角色动态
   - 记录新发现
   ↓
3. 🌍 使用 02-世界观提取器.md 更新世界观
   - 力量体系
   - 地理设定
   - 社会制度
   ↓
4. 👥 使用 03-角色分析器.md 更新角色
   - 角色档案
   - 角色关系
   - 角色成长
   ↓
5. 📝 生成章节摘要
   - 保存到 data/chapter_summaries/chapter_N.json
   ↓
6. 💾 更新进度
   - 更新 tools/progress.json
   ↓
7. ✅ 标记完成，继续下一章
```

### 每10章（回顾点）：

```
1. 📊 统计分析
   - 累积角色数量
   - 累积地点数量
   - 累积物品数量
   ↓
2. 🔍 质量检查
   - 检查最近10章的摘要
   - 验证信息完整性
   - 确认数据一致性
   ↓
3. 📄 生成回顾报告
   - 保存到 data/reviews/review_X.md
   ↓
4. ✅ 自动批准
   - 在报告中标记"已批准"
   ↓
5. 🚀 继续下一批次
```

---

## 📁 生成的文件

处理过程中，我会创建以下文件：

```
novel-game-framework/
├── agent_instructions/          # Agent指令文件
│   ├── CURRENT_TASK.md         # 主指令（会实时更新）
│   ├── task_chapter_XX.md      # 章节任务
│   └── review_X.md             # 回顾任务
│
├── data/                        # 分析数据
│   ├── accumulated_context.json     # 累积上下文
│   ├── world_setting.json           # 世界观设定
│   ├── characters.json              # 角色档案
│   │
│   ├── chapter_summaries/           # 章节摘要
│   │   ├── chapter_1.json
│   │   ├── chapter_2.json
│   │   └── ...
│   │
│   └── reviews/                     # 回顾报告
│       ├── review_1.md              # 第1-10章
│       ├── review_2.md              # 第11-20章
│       └── ...
│
└── tools/
    └── progress.json            # 进度跟踪（实时更新）
```

---

## 🔍 监控进度

### 查看当前进度

```bash
cat tools/progress.json
```

### 查看最新章节摘要

```bash
ls -lt data/chapter_summaries/ | head -5
```

### 查看回顾报告

```bash
cat data/reviews/review_1.md
```

### 查看当前任务

```bash
cat agent_instructions/CURRENT_TASK.md
```

---

## ⏸️ 暂停和恢复

### 暂停处理

直接对我说：

> 暂停处理，保存当前进度

或者按 Ctrl+C（如果在脚本中运行）

### 恢复处理

再次运行启动脚本：

```bash
./START_AGENT_PROCESSOR.sh
```

或者直接对我说：

> 继续处理小说，从上次进度开始

我会自动从 `tools/progress.json` 读取上次的进度并继续。

---

## 📊 当前状态

根据 `tools/progress.json`：

- **当前章节**: 22/1694
- **完成进度**: 1.3%
- **下一章**: 第23章
- **下次回顾**: 第30章（还有8章）

---

## ⚙️ 配置选项

在 `agent_novel_processor.py` 中可以修改：

```python
generator = AgentInstructionGenerator(
    novel_path="novel/斗破苍穹.txt",    # 小说文件路径
    project_name="斗破苍穹游戏",         # 项目名称
    review_interval=10                   # 回顾间隔（章节数）
)
```

---

## 💡 使用技巧

### 1. 一次性处理

对我说：

> 请按照指令处理从第23章到第50章，不要中断

我会连续处理这些章节。

### 2. 批量处理

对我说：

> 请处理接下来的10章，完成后暂停

我会处理10章后停止，等待您的下一步指示。

### 3. 加速处理

对我说：

> 请快速处理，只提取关键信息

我会加快速度，重点关注核心内容。

### 4. 详细分析

对我说：

> 请详细分析，不要遗漏任何细节

我会更仔细地分析每个方面。

---

## ⚠️ 重要提醒

### 我会遵守的原则：

1. ✅ **完整阅读每一章** - 不跳过任何内容
2. ✅ **逐章处理** - 不批量，确保质量
3. ✅ **详细分析** - 使用所有相关提示词
4. ✅ **实时保存** - 每章完成后立即保存进度
5. ✅ **定期回顾** - 每10章检查质量
6. ✅ **自动批准** - 回顾后自动继续

### 您可以随时：

- 🔍 **查看进度** - 询问当前处理到哪里
- ⏸️ **暂停处理** - 让我停下来
- 🔄 **恢复处理** - 让我继续
- 📊 **查看统计** - 询问累积发现了多少角色/地点/物品
- 📝 **查看摘要** - 询问某一章的内容
- ✏️ **修改数据** - 如果发现错误，可以要求我修正

---

## 🎯 开始执行

### 方式一：使用启动脚本

```bash
./START_AGENT_PROCESSOR.sh
```

### 方式二：直接对我说

> 请读取 agent_instructions/CURRENT_TASK.md 并开始处理小说

### 方式三：简单指令

> 开始处理小说，从第23章继续

---

## ❓ 常见问题

### Q: 处理速度如何？

A: 取决于章节长度和分析深度：
- 快速模式：约 30-60 秒/章
- 标准模式：约 1-2 分钟/章
- 详细模式：约 2-5 分钟/章

### Q: 会自动保存吗？

A: 是的，每章完成后自动保存所有数据和进度。

### Q: 如果中途出错怎么办？

A: 进度已保存，直接让我继续即可，我会从上次的地方开始。

### Q: 可以跳过某些章节吗？

A: 不建议跳过，但如果确实需要，可以手动修改 `tools/progress.json` 中的 `current_chapter`。

### Q: 如何查看处理质量？

A: 查看 `data/reviews/` 目录下的回顾报告，每10章有一次质量评估。

---

## 🎉 准备好了吗？

**现在就开始吧！** 运行启动脚本：

```bash
./START_AGENT_PROCESSOR.sh
```

或者直接对我说：

> 开始处理小说！

我会立即开始工作，自动处理整个小说，直到完成！🚀

---

**有任何问题，随时问我！** 😊
