#!/bin/bash
################################################################################
# Agent驱动的小说处理系统 - 启动脚本
################################################################################
#
# 使用方法：
# 1. 在 Claude Code 中运行此脚本
# 2. Agent 会自动读取指令并处理整个小说
#
################################################################################

echo "╔═══════════════════════════════════════════════════════════════════╗"
echo "║          🤖 Agent驱动的小说处理系统 - 启动中...                     ║"
echo "╚═══════════════════════════════════════════════════════════════════╝"
echo ""

# 步骤1: 生成指令文件
echo "📝 步骤 1: 生成Agent指令文件..."
python3 agent_novel_processor.py

if [ $? -ne 0 ]; then
    echo "❌ 指令生成失败"
    exit 1
fi

echo ""
echo "✅ 指令文件已生成"
echo ""

# 步骤2: 显示指令文件位置
echo "╔═══════════════════════════════════════════════════════════════════╗"
echo "║                     📋 Agent 任务已就绪                              ║"
echo "╚═══════════════════════════════════════════════════════════════════╝"
echo ""
echo "📄 主指令文件: agent_instructions/CURRENT_TASK.md"
echo ""
echo "🤖 Claude Code Agent 应该:"
echo "   1. 读取主指令文件"
echo "   2. 按照指令逐章处理小说"
echo "   3. 每10章自动回顾检查"
echo "   4. 自动批准并继续"
echo ""
echo "⚠️  重要提醒:"
echo "   - 不要跳过任何章节"
echo "   - 不要省略阅读步骤"
echo "   - 每章都要完整分析"
echo "   - 及时保存进度"
echo ""
echo "╔═══════════════════════════════════════════════════════════════════╗"
echo "║                   🚀 现在开始执行任务！                              ║"
echo "╚═══════════════════════════════════════════════════════════════════╝"
echo ""

# 显示指令内容（前50行）
echo "📖 主指令文件内容预览:"
echo "-------------------------------------------------------------------"
head -50 agent_instructions/CURRENT_TASK.md
echo "..."
echo "-------------------------------------------------------------------"
echo ""
echo "✅ 准备就绪！Agent 可以开始处理了！"
echo ""
